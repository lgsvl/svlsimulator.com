<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="LG Electronics America R&D Lab">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Python API guide - SVL Simulator</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Python API guide";
    var mkdocs_page_input_path = "python-api/python-api.md";
    var mkdocs_page_url = "/docs/python-api/python-api/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-130546445-1', 'svlsimulator.com');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <!-- edit link, open in new tab -->
        <a href="https://svlsimulator.com/docs/" class="icon icon-home" target="_blank_"> SVL Simulator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Release Notes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../release-notes/release-features/">Release features</a>
                </li>
                <li class="">
                    
    <a class="" href="../../release-notes/changelog/">Release notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../release-notes/release-contents/">Contents of this release</a>
                </li>
                <li class="">
                    
    <a class="" href="../../release-notes/limitations-license-notice/">Limitations and license notice</a>
                </li>
                <li class="">
                    
    <a class="" href="../../archive/">Previous releases</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installation Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../installation-guide/system-requirements/">System requirements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation-guide/installing-simulator/">Installation procedure</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation-guide/build-instructions/">Building from source</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation-guide/debugging-scripts/">Debugging Unity scripts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation-guide/running-linux-gpu-applications-on-windows/">Running Linux GPU applications on Windows</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../getting-started/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/conventions/">Conventions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/getting-started/">Run a simulation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../tutorials/modular-testing/">Modular testing with the Apollo AD stack</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/lane-following/">Deep learning lane following model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/create-ros2-ad-stack/">Creating a simple ROS2-based AD stack</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/ground-truth-obstacles/">Viewing and subscribing to ground truth obstacles</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/robotics-pub-sub/">Running a basic Robotics Simulation with ROS 2</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/robotics-ros2/">Robot simulation with ROS 2 Navigation Stack</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/robotics-mapping/">Mapping a simulation environment in ROS 2</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/local-automation-tutorial/">Local Automation (CI/CD) Tutorial</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/running-on-aws/">Running SVL Simulator on AWS</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">User Interface</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Web User Interface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/web/store/">Store</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/web/library/">Library</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/web/clusters/">Clusters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/web/simulations/">Simulations</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/web/test-results/">Test Results</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Simulation User Interface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/simulator-main-menu/">Simulator main menu</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/simulation-menu/">Simulation menu</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/sensor-visualizers/">Sensor visualizers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/bridge-connection-ui/">Bridge connection UI</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/config-and-cmd-line-params/">Configuration file and command line parameters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../user-interface/keyboard-shortcuts/">Keyboard shortcuts</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">System Under Test</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../system-under-test/sut-introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Messages</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/simulator-messages/">Simulator messages</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/lgsvl-msgs/">The lgsvl_msgs package</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/sensor-message-publishing/">Sensor message publishing</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../system-under-test/autoware-instructions/">ROS (Autoware.AI)</a>
                </li>
                <li class="">
                    
    <span class="caption-text">ROS 2</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/autoware-auto-instructions/">Autoware.Auto</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/ros2-bridge/">Setting up ROS 2 bridge</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Apollo</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/apollo-master-instructions/">Latest Apollo</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system-under-test/apollo5-0-instructions/">Apollo 5.0</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Running Simulations</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../running-simulations/runtime-templates/">Runtime templates</a>
                </li>
                <li class="">
                    
    <a class="" href="../../running-simulations/running-simulator/">Running Simulator</a>
                </li>
                <li class="">
                    
    <a class="" href="../../running-simulations/offline-mode/">Offline mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../running-simulations/developer-mode/">Developer mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../running-simulations/local-automation/">Local Automation (CI/CD)</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Creating Scenarios</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Visual scenario editor (VSE)</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../visual-scenario-editor/about-vse/">About VSE</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../visual-scenario-editor/using-vse/">Using VSE</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../visual-scenario-editor/vse-inspector/">VSE Inspector</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../visual-scenario-editor/vse-editors/">VSE Editors</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../visual-scenario-editor/vse-extensions/">VSE Extensions</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Python API</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Python API guide</a>
    <ul class="subnav">
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../api-quickstart-descriptions/">Python API quickstart guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../dreamview-api/">Dreamview API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Simulation Content</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../simulation-content/sharing/">Sharing assets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../simulation-content/assets/">Building content</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Maps</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/add-new-map/">Creating a new map</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/map-annotation/">Map annotation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/hd-map-mesh-generation/">Road network generation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/add-destinations/">Adding destinations to a map</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/pointcloud-import/">Point cloud import</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/pointcloud-rendering/">Point cloud rendering</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/pointcloud-export/">Point cloud export</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/lane-line-detector/">Lane-line detector</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/lighting-for-interiors/">Lighting for indoor environments</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Vehicles</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/add-new-ego-vehicle/">Creating a new ego vehicle</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/ego-vehicle-dynamics/">Vehicle dynamics</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Sensors</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/sensors-list/">List of sensors</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/lane-line-sensor/">Lane-line sensor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/differential-drive-control/">Differential Drive Control sensor</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">SDF</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../simulation-content/sdf-import/">Importing SDF world files</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../plugins/sensor-plugins/">Sensor plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/bridge-plugins/">Bridge plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/controllable-plugins/">Controllable plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/npc-plugins/">NPC plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/pedestrian-plugins/">Pedestrian plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/developer-debug-mode/">Developer Debug mode</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Digital Twin</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../digital-twin/gomentum-dtl/">Digital Twin Lite example map</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Distributed Simulation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../distributed-simulation/distributed-simulation-introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../distributed-simulation/running-distributed-simulation/">Running distributed simulation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Third Party Integration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../third-party-integration/openai-gym/">OpenAI Gym</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Support</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../support/troubleshooting/">Troubleshooting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../support/unity-help/">Unity help</a>
                </li>
                <li class="">
                    
    <a class="" href="../../support/faq/">Frequently asked questions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../support/contributing/">Contributing</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SVL Simulator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Python API &raquo;</li>
        
      
    
    <li>Python API guide</li>
    <li class="wy-breadcrumbs-aside">
      
      <!-- edited to not display Github edit link -->
        <a style="display:none;" href="https://github.com/lgsvl/simulator/edit/master/Docs/python-api/python-api.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="python-api-guide"><a name="top"></a> Python API Guide<a class="headerlink" href="#python-api-guide" title="Permanent link">#</a></h1>
<h2 id="overview">Overview <a class="wikilink" href="#top">top</a><a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>SVL Simulator exposes runtime functionality to a Python API which you can use
to manipulate object placement and vehicle movement in a loaded scene, retrieve
sensor configuration and data, control weather, time state, and more.</p>
<p>The interface to listen for incoming API calls is defined in <code>config.yml</code>. See
<a href="../../user-interface/config-and-cmd-line-params/">Configuration File and Command-Line Parameters</a>
for more information.</p>
<h2> Table of Contents</h2>
<div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#quickstart">Quickstart</a></li>
<li><a href="#core-concepts">Core Concepts</a></li>
<li><a href="#simulation">Simulation</a><ul>
<li><a href="#non-realtime-simulation">Non-real-time Simulation</a></li>
</ul>
</li>
<li><a href="#agents">Agents</a><ul>
<li><a href="#ego-vehicle">EGO Vehicle</a></li>
<li><a href="#npc-vehicles">NPC Vehicles</a></li>
<li><a href="#pedestrians">Pedestrians</a></li>
</ul>
</li>
<li><a href="#callbacks">Callbacks</a><ul>
<li><a href="#agent-callbacks">Agent Callbacks</a></li>
<li><a href="#egovehicle-callbacks">'EgoVehicle</a></li>
<li><a href="#npcvehicle-callbacks">NpcVehicle Callbacks</a></li>
<li><a href="#pedestrian-callbacks">Pedestrian Callbacks</a></li>
</ul>
</li>
<li><a href="#sensors">Sensors</a><ul>
<li><a href="#camera-sensor">Camera Sensor</a></li>
<li><a href="#lidar-sensor">LiDAR Sensor</a></li>
<li><a href="#imu-sensor">IMU Sensor</a></li>
<li><a href="#gps-sensor">GPS Sensor</a></li>
<li><a href="#radar-sensor">Radar Sensor</a></li>
<li><a href="#can-bus">CAN bus</a></li>
<li><a href="#video-recording">Video Recording Sensor</a></li>
</ul>
</li>
<li><a href="#weather-and-time-of-day-control">Weather and Time of Day Control</a></li>
<li><a href="#controllable-objects">Controllable Objects</a></li>
<li><a href="#helper-functions">Helper Functions</a></li>
<li><a href="#changelog">Changelog</a></li>
</ul>
</div>
<h2 id="requirements">Requirements <a class="wikilink" href="#top">top</a><a class="headerlink" href="#requirements" title="Permanent link">#</a></h2>
<p>Using Python API requires Python version 3.6 or later.</p>
<h2 id="quickstart">Quickstart <a class="wikilink" href="#top">top</a><a class="headerlink" href="#quickstart" title="Permanent link">#</a></h2>
<p>Python API is available in separate repository: <a href="https://github.com/lgsvl/PythonAPI">https://github.com/lgsvl/PythonAPI</a></p>
<p>After cloning or downloading it from the git repository follow these steps:</p>
<ol>
<li>
<p>Run the following command to install Python files and necessary dependencies:</p>
<pre><code>pip3 install --user -e .
</code></pre>
</li>
<li>
<p>Now launch the simulator, either using the binary file or from Unity Editor. The simulator
   by default listens for connections on port <strong>8181</strong> on <strong>localhost</strong>. See the guide for <a href="../../running-simulations/running-simulator/">Running SVL Simulator</a> for more information on how to set up and run the simulator.</p>
</li>
<li>
<p>Click the <strong>Open Browser</strong> button to open the Simulator UI, then click <strong>Sign in</strong>. Enter login credentials or click <strong>Sign Up</strong> to create an account.</p>
</li>
<li>
<p>You will need to add assets such as maps and vehicles to your library to use in simulations. These assets can either be added from the <a href="../../user-interface/web/store/">Store</a> or uploaded to the cloud. Quickstart scripts require the <code>BorregasAve</code> map and the <code>Lincoln2017MKZ</code> vehicle, which are included in your library by default.</p>
</li>
<li>
<p>You will need to run a simulation using the <strong>API Only</strong> runtime template to run Python API scripts on your host machine to control the simulation. See the document on <a href="../../user-interface/web/simulations/">Simulations</a> for information on how to create a simulation.</p>
</li>
<li>
<p>Select the newly created Simulation and click the <strong>Run Simulation</strong> button.</p>
</li>
<li>
<p>Run the following example to see the API in action:</p>
<pre><code>./quickstart/05-ego-drive-in-circle.py
</code></pre>
</li>
</ol>
<p>This will load the <code>BorregasAve.unity</code> scene, instantiate one EGO vehicle, then ask
you to press <strong>Enter</strong> to start driving EGO vehicle in a circle. When the script is running, it will apply throttle and steering commands to make the car move.</p>
<h2 id="core-concepts">Core concepts <a class="wikilink" href="#top">top</a><a class="headerlink" href="#core-concepts" title="Permanent link">#</a></h2>
<p>The Simulator and API communicate by sending json over a websocket server running on port <strong>8181</strong>. The API client can either be on the same machine or on any other machine on
the same network.</p>
<p>API exposes the following main types:</p>
<ul>
<li><strong>Simulator</strong> - main object for connecting to simulator and creating other objects</li>
<li><strong>Agent</strong> - superclass of vehicles and pedestrian</li>
<li><strong>EgoVehicle</strong> - <a href="#ego-vehicle">EGO vehicle</a> with accurate physics simulation and
   <a href="#sensors">sensors</a></li>
<li><strong>NpcVehicle</strong> - <a href="#npc-vehicles">NPC vehicle</a> with simplified physics, useful for
   creating many background vehicles</li>
<li><strong>Pedestrian</strong> - <a href="#pedestrians">pedestrian</a> walking on sidewalks</li>
</ul>
<p>Vehicles and Pedestrian are a subclasses of <code>Agent</code> which has common properties like
<code>transform</code>, <code>position</code>, and <code>velocity</code>.</p>
<p>All coordinates in the API return values in the Unity coordinate system. This coordinate
system uses meters as a unit of distance and is a left-handed coordinate system where x points left,
z points forward, and y points up.</p>
<p>The Simulator class provides helper methods to convert coordinates to and from
latitude/longitude and northing/easting values.</p>
<h2 id="simulation">Simulation <a class="wikilink" href="#top">top</a><a class="headerlink" href="#simulation" title="Permanent link">#</a></h2>
<p>To connect to the simulator you need to an instance of the <code>Simulator</code> class:</p>
<pre><code class="language-python">import lgsvl
sim = lgsvl.Simulator(address = &quot;localhost&quot;, port = 8181)
</code></pre>
<p>You can specify a different address as hostname or IP address. By default only port <strong>8181</strong> is
used for API connection. Only one client can be connected to simulator at a time.</p>
<p>Next, load the scene (sometimes called map). This is done by the <code>load</code> method:</p>
<pre><code class="language-python">sim.load(scene = &quot;aae03d2a-b7ca-4a88-9e41-9035287a12cc&quot;, seed = 650387)
</code></pre>
<p><code>scene</code> is a string representing the UUID of the <em>Map</em> in the Web UI. Scenes can be added either from the map tab under <strong>Store</strong> or by manually uploading. Some of the well-known scenes available in the <em>Map</em> tab under <strong>Store</strong> are:</p>
<table>
<thead>
<tr>
<th>Map name</th>
<th>UUID</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>BorregasAve</strong></td>
<td><code>aae03d2a-b7ca-4a88-9e41-9035287a12cc</code></td>
<td>a Digital Twin of a real-world suburban street block in Sunnyvale, CA</td>
</tr>
<tr>
<td><strong>AutonomouStuff</strong></td>
<td><code>2aae5d39-a11c-4516-87c4-cdc9ca784551</code></td>
<td>small office parking lot in SanJose, CA</td>
</tr>
<tr>
<td><strong>Shalun</strong></td>
<td><code>97128028-33c7-4411-b1ec-d693ed35071f</code></td>
<td>an autonomous vehicle testing facility in Taiwan (More information <a href="http://taiwancarlab.narlabs.org.tw/index_en.html">here</a>)</td>
</tr>
<tr>
<td><strong>SanFrancisco</strong></td>
<td><code>5d272540-f689-4355-83c7-03bf11b6865f</code></td>
<td>a real world urban environment from San Francisco, CA</td>
</tr>
<tr>
<td><strong>GoMentum Station</strong></td>
<td><code>979dd7f3-b25b-47f0-ab10-a6effb370138</code></td>
<td>a Digital Twin of a real-world autonomous vehicle testing facility in Concord, CA</td>
</tr>
<tr>
<td><strong>CubeTown</strong></td>
<td><code>06773677-1ce3-492f-9fe2-b3147e126e27</code></td>
<td>a virtual environment with block obstacles used to perform basic testing of vehicles</td>
</tr>
<tr>
<td><strong>SingleLaneRoad</strong></td>
<td><code>a6e2d149-6a18-4b83-9029-4411d7b2e69a</code></td>
<td>a simple two-way single-lane road</td>
</tr>
</tbody>
</table>
<p>Seed (optional) is an Integer (-2,147,483,648 - 2,147,483,647) that determines the "random" behavior of the NPC vehicles and rain effects.</p>
<p>Check out the <a href="../../user-interface/web/store/">Store</a> in the Web UI for list of available scenes.</p>
<p>Once a scene is loaded you can instantiate agents and run simulations. See
the <a href="#agents">Agents</a> section on how to create vehicles and pedestrians.</p>
<p>Loading scenes takes a while, to reset a scene to the initial state without reloading it call the <code>reset</code>
method:</p>
<pre><code class="language-python">sim.reset()
</code></pre>
<p>This will remove any vehicles or callbacks currently registered.</p>
<p>After setting up the scene in a desired state you can start advancing time.
During Python code execution time is stopped in the simulator. To run the simulator in realtime, call the <code>run</code> method:</p>
<pre><code class="language-python">sim.run(time_limit = 5.0)
</code></pre>
<p><code>run</code> accepts an optional argument for a time limit specifying how long to run. The default
value of 0 will run infinitely.</p>
<p>Diagram illustrating API execution:</p>
<p><img alt="" src="../../images/python-api-execution.png" /></p>
<h3 id="non-realtime-simulation">Non-real-time Simulation <a class="wikilink" href="#top">top</a><a class="headerlink" href="#non-realtime-simulation" title="Permanent link">#</a></h3>
<p>The simulator can be run at faster-than-real-time speeds depending on the performance of the computer running the simulator.
This is done by calling the <code>run</code> method with the <code>time_scale</code> argument:</p>
<pre><code class="language-python">sim.run(time_limit = 6, time_scale = 2)
</code></pre>
<p><code>run</code> takes a 2nd optional argument specifying how much faster to run.
In the above example, if the computer is fast enough, the run call will finish in 3 seconds (6 divided by 2),
but 6 virtual seconds of data would be generated. If only <code>time_scale</code> is specified or <code>time_limit</code> = 0,
then simulation will run continuously at non-realtime speed.</p>
<p>The value of time_scale can be lower than 1 which gives ability to run simulation in slower than real time.</p>
<h2 id="agents">Agents <a class="wikilink" href="#top">top</a><a class="headerlink" href="#agents" title="Permanent link">#</a></h2>
<p>You can create vehicles and pedestrians by calling the <code>add_agent</code> method of the <code>Simulator</code>
object. Example:</p>
<pre><code class="language-python">ego = sim.add_agent(name = &quot;511086bd-97ad-4109-b0ad-654ba662fbcf&quot;, \
agent_type = lgsvl.AgentType.EGO, state = None)
</code></pre>
<p>This will create the <code>Lincoln2017MKZ</code> vehicle with the <strong>Keyboard Control</strong> sensor configuration. This vehicle and sensor configuration are available by default in <strong>My Library</strong>. In this instance the UUID for the desired sensor configuration is entered for the <code>name</code> argument.</p>
<p>The currently available <code>AgentTypes</code> are:</p>
<ul>
<li><strong>AgentType.EGO</strong> - EGO vehicle</li>
<li><strong>AgentType.NPC</strong> - NPC vehicle</li>
<li><strong>AgentType.PEDESTRIAN</strong> - pedestrian</li>
</ul>
<p>Ego agents are called by the UUIDs of their sensor configurations in the WebUI. To access the UUID of a sensor configuration click on a particular vehicle in <strong>My Library</strong> to expand the detailed view and click on the <strong>ID</strong> icon for the desired sensor configuration to copy its UUID to the clipboard.</p>
<p><img alt="" src="../../images/python-api/sensor-config-uuid.png" /></p>
<p>NPC agents are called by their name directly. Available NPC vehicles:</p>
<ul>
<li><strong>Sedan</strong></li>
<li><strong>SUV</strong></li>
<li><strong>Jeep</strong></li>
<li><strong>Hatchback</strong></li>
<li><strong>SchoolBus</strong></li>
<li><strong>BoxTruck</strong></li>
</ul>
<p>Similarly, pedestrian agents are also called by their names directly. Available pedestrian types:</p>
<ul>
<li><strong>Bob</strong></li>
<li><strong>EntrepreneurFemale</strong></li>
<li><strong>Howard</strong></li>
<li><strong>Johny</strong></li>
<li><strong>Pamela</strong></li>
<li><strong>Presley</strong></li>
<li><strong>Red</strong></li>
<li><strong>Robin</strong></li>
<li><strong>Stephen</strong></li>
<li><strong>Zoe</strong></li>
</ul>
<p>If an incorrect name is entered, a Python exception will be thrown.</p>
<p>Optionally you can create agents in specific positions and orientations in the scene.
For this you need to use the <code>AgentState</code> class. For example:</p>
<pre><code class="language-python">state = lgsvl.AgentState()
state.transform.position = lgsvl.Vector(10, 0, 30)
state.transform.rotation.y = 90
ego = sim.add_agent(&quot;511086bd-97ad-4109-b0ad-654ba662fbcf&quot;, lgsvl.AgentType.EGO, state)
</code></pre>
<p>This will create a vehicle at position <em>x = 10</em>, <em>z = 30</em>  which is rotated <em>90</em> degrees around the
vertical axis. The position and rotation are set in the world coordinates space.</p>
<p>You can always adjust the position, rotation, velocity and angular velocity of the agent
at any later time:</p>
<pre><code class="language-python">s = ego.state
s.velocity.x = -50
ego.state = s
</code></pre>
<p>This will set x component of velocity (in world coordinate space) to <em>-50</em> meters
per second and leave <em>y</em> and <em>z</em> components of velocity unmodified.</p>
<p>All agents have the following common functionality:</p>
<ul>
<li><code>state</code> - property to get or set agent state (position, velocity, ...)</li>
<li><code>transform</code> - property to get <code>transform</code> member of the state (shortcut for
     <code>state.transform</code>)</li>
<li><code>bounding_box</code> - property to get bounding box in local coordinate space.
   Note that bounding box is not centered around <em>(0, 0, 0)</em> - it depends on the actual
   geometry of the agent.</li>
<li><code>on_collision</code> - method to set a callback function to be called when the agent
   collides with something (other agent or static obstacle), see <a href="#callbacks">callbacks</a>
   section for more information.</li>
</ul>
<h3 id="ego-vehicle">EGO vehicle <a class="wikilink" href="#top">top</a><a class="headerlink" href="#ego-vehicle" title="Permanent link">#</a></h3>
<p>EGO vehicle has following additional functionality:</p>
<ul>
<li><code>apply_control</code> - method to apply specified throttle, break, steering or other
    actions to vehicle. Pass <code>sticky=True</code> to apply these values on every simulation
    update iteration.</li>
<li><code>get_sensors</code> - method to return list of Python-Api compatible <a href="#sensors">sensors</a></li>
<li><code>connect_bridge</code> - method to connect to ROS or Cyber RT bridge</li>
<li><code>bridge_connected</code> - bool property, <code>True</code> if bridge is connected</li>
<li><code>set_initial_pose</code> - method to publish an initial pose of EGO vehicle to ROS</li>
<li><code>set_destination</code> - method to publish a destination pose of EGO vehicle to ROS</li>
</ul>
<p>You can control the movement of the EGO vehicle either by manually specifying state, applying
manual control, or connecting through the bridge.</p>
<p>Example to apply constant 20% throttle to EGO vehicle:</p>
<pre><code class="language-python">ego = sim.add_agent(&quot;Lincoln2017MKZ (Apollo 5.0)&quot;, lgsvl.AgentType.EGO)
c = lgsvl.VehicleControl()
c.throttle = 0.2
ego.apply_control(c, True)
</code></pre>
<h3 id="npc-vehicles">NPC vehicles <a class="wikilink" href="#top">top</a><a class="headerlink" href="#npc-vehicles" title="Permanent link">#</a></h3>
<p>You can create multiple NPC vehicles on the map to drive along the lanes or follow specific
waypoints on the map.</p>
<p>NPC vehicle has the following additional functionality:</p>
<ul>
<li><code>change_lane</code> - method to make the vehicle change lanes</li>
<li><code>follow</code> - method to make vehicle follow specific waypoints</li>
<li><code>follow_closest_lane</code> - method to make vehicle follow lanes</li>
<li><code>on_waypoint_reached</code> - method to set callback function which is called for every
    waypoint the vehicle reaches</li>
<li><code>on_stop_line</code> - method to set callback function which is called when vehicle
    reaches a stop line at intersection</li>
<li><code>on_lane_change</code> - method to set callback function which is called when vehicle
    decides to change lanes</li>
</ul>
<p>You can control the movement of an NPC vehicle either by manually specifying state, or
instructing it to follow waypoints or lanes.</p>
<p>To make an NPC follow waypoints prepare a list of <code>DriveWaypoint</code> objects and call
the <code>follow</code> method for the npc vehicle:</p>
<pre><code class="language-python">npc = sim.add_agent(&quot;Sedan&quot;, lgsvl.AgentType.NPC)
waypoints = [
  lgsvl.DriveWaypoint(lgsvl.Vector(1,0,3), 5, lgsvl.Vector(0, 0, 0), 0, False, 0),
  lgsvl.DriveWaypoint(lgsvl.Vector(5,0,3), 10, lgsvl.Vector(0, 0, 0), 0, False, 0),
  lgsvl.DriveWaypoint(lgsvl.Vector(1,0,5), 5, lgsvl.Vector(0, 0, 0), 0, False, 0),
]
npc.follow(waypoints, loop=True)
</code></pre>
<p>Each waypoint has a position in world coordinates, a desired velocity in m/s, a desired angular orientation as a vector of Euler angles, an optional wait-time for the vehicle to stay idle, an bool on whether the NPC should be active while idling, and an optional trigger distance. The NPC
will ignore all traffic rules and will not avoid collisions to try to get to the next
waypoint. The angular orientation of the NPC will be interpolated in such a manner that it will pass through the waypoint at the angle specified in the <code>DriveWaypoint</code>. The trigger distance, if used, provides a method to pause the NPC until an ego vehicle approaches. The NPC will begin to drive as soon as its distance to an ego vehicle drops below the value specified as trigger distance in the <code>DriveWaypoint</code>.
You can receive information on progress by setting the <code>on_waypoint_reached</code>
callback. Example (see <a href="#callbacks">callbacks</a> for more details):</p>
<pre><code class="language-python">npc = sim.add_agent(&quot;Sedan&quot;, lgsvl.AgentType.NPC)

def on_waypoint(agent, index):
  print(&quot;waypoint {} reached&quot;.format(index))

npc.follow(waypoints, loop=True)
npc.on_waypoint_reached(on_waypoint)

sim.run()
</code></pre>
<p><code>follow_closest_lane</code> will make the NPC vehicle follow whatever lane is the closest.
Upon reaching intersections it will randomly decide to either drive straight or turn.</p>
<p>You can also spawn a pool of NPC vehicles with the same behavior as NPCs added to a non-API simulation. They will follow the map annotations, obey speed limits, obey traffic signals, and attempt to avoid accidents. These NPCs cannot be directly controlled.</p>
<pre><code class="language-python">sim.add_random_agents(lgsvl.AgentType.NPC)
</code></pre>
<h3 id="pedestrians">Pedestrians <a class="wikilink" href="#top">top</a><a class="headerlink" href="#pedestrians" title="Permanent link">#</a></h3>
<p>You can create <code>Pedestrian</code> agents that will allow you to create pedestrians on sidewalks
and make them walk.</p>
<p>Pedestrians have the following additional functionality:</p>
<ul>
<li><code>walk_randomly</code> - method to make pedestrian walk randomly on the sidewalk</li>
<li><code>follow</code> - method to make pedestrian follow specific waypoints</li>
<li><code>on_waypoint_reached</code> - method to set callback function which is called for every
    waypoint reached</li>
</ul>
<p>You can control the movement of pedestrians either by manually specifying state, or
instructing them to follow waypoints or walk randomly.</p>
<p>To make pedestrians follow waypoints prepare a list of <code>WalkWaypoint</code> objects and call
the <code>follow</code> method for pedestrians:</p>
<pre><code class="language-python">npc = sim.add_agent(&quot;Bob&quot;, lgsvl.AgentType.PEDESTRIAN)
waypoints = [
  lgsvl.WalkWaypoint(lgsvl.Vector(1,0,3), 5, 0),
  lgsvl.WalkWaypoint(lgsvl.Vector(5,0,3), 10, 0),
  lgsvl.WalkWaypoint(lgsvl.Vector(1,0,5), 5, 0),
]
npc.follow(waypoints, loop=True)
</code></pre>
<p>Each waypoint has a position in world coordinates, an optional idle time that the pedestrian will
spend standing in-place when it reaches the waypoint, and an optional trigger distance. You can receive information on progress by
setting the <code>on_waypoint_reached</code> callback.</p>
<p>You can also spawn a pool of pedestrians with the same behavior as pedestrians added to a non-API simulation. They will follow the map annotations and path find. These pedestrians cannot be directly controlled.</p>
<pre><code class="language-python">sim.add_random_agents(lgsvl.AgentType.PEDESTRIAN)
</code></pre>
<h2 id="callbacks">Callbacks <a class="wikilink" href="#top">top</a><a class="headerlink" href="#callbacks" title="Permanent link">#</a></h2>
<p>The Python API can invoke callbacks to inform you of specific events that occur during
simulator runtime. Callbacks are invoked from inside the <code>Simulator.run()</code> method and
while a callback is running the simulation time is paused. Once the callback finishes time is resumed and the simulation resumes execution. You can call <code>Simulator.stop()</code>
to stop further execution and return immediately from the callback.</p>
<p>The internals of this process are illustrated in the following sequence diagram:</p>
<p><img alt="" src="../../images/python-api-callbacks.png" /></p>
<p>Here the code resumes simulation after the first callback, but stops execution when the second
callback is handled.</p>
<p>You set callback functions by calling <code>on_NAME</code> method of object, see information below.</p>
<h3 id="agent-callbacks"><a href="#agents">Agent</a> Callbacks <a class="wikilink" href="#top">top</a><a class="headerlink" href="#agent-callbacks" title="Permanent link">#</a></h3>
<p><code>on_collision</code> - called when agent collides with something (other agent or stationary
obstacle).</p>
<p>Example usage:</p>
<pre><code class="language-python">def on_collision(agent1, agent2, contact):
  name1 = &quot;STATIC OBSTACLE&quot; if agent1 is None else agent1.name
  name2 = &quot;STATIC OBSTACLE&quot; if agent2 is None else agent2.name
  print(&quot;{} collided with {} at {}&quot;.format(name1, name2, contact))

ego.on_collision(on_collision)
</code></pre>
<p>Callback receives three arguments: <code>(agent1, agent2, contact)</code> - the first two are the agents that collide,
one of them can be None if it is a stationary obstacle like a building or a traffic light pole,
and the third is the world position of the contact point.</p>
<h3 Callbacks="Callbacks" id="egovehicle-callbacks"><a href="#ego-vehicles">EgoVehicle</a> Callbacks <a class="wikilink" href="#top">top</a><a class="headerlink" href="#egovehicle-callbacks" title="Permanent link">#</a></h3>
<p>In addition to Agent callbacks, <code>EgoVehicle</code> has one extra callback.</p>
<p><code>on_custom</code> - called when a Sensor Plugin sends a callback; accepts three arguments:
<code>(agent, kind, context)</code> - agent instance, kind of sensor plugin as string, JSON context</p>
<p>See <a href="../../plugins/sensor-plugins/">Sensor Plugins</a> for more information.</p>
<h3 id="npcvehicle-callbacks"><a href="#npc-vehicles">NpcVehicle</a> Callbacks <a class="wikilink" href="#top">top</a><a class="headerlink" href="#npcvehicle-callbacks" title="Permanent link">#</a></h3>
<p>In addition to Agent callbacks, <code>NpcVehicle</code> has three extra callbacks:</p>
<p><code>on_waypoint_reached</code> - called when vehicle reaches a waypoint; accepts two
arguments: <code>(agent, index)</code> - agent instance and waypoint index as integer</p>
<p><code>on_stop_line</code> - called when vehicle stops at a stop line for a traffic light or stop sign; accepts one argument: <code>(agent)</code> - agent instance</p>
<p><code>on_lane_change</code> - called when vehicle starts changing lane; accepts one
argument: <code>(agent)</code> - agent instance</p>
<h3 id="pedestrian-callbacks"><a href="#pedestrians">Pedestrian</a> Callbacks <a class="wikilink" href="#top">top</a><a class="headerlink" href="#pedestrian-callbacks" title="Permanent link">#</a></h3>
<p>In addition to <code>Agent</code> callbacks, <code>Pedestrian</code> has one extra callback.</p>
<p><code>on_waypoint_reached</code> - called when pedestrian reaches waypoint; accepts two
arguments: <code>(agent, index)</code> - agent instance and waypoint index as integer.</p>
<h2 id="sensors">Sensors <a class="wikilink" href="#top">top</a><a class="headerlink" href="#sensors" title="Permanent link">#</a></h2>
<p><a href="#ego-vehicle">EGO vehicles</a> have sensors attached. You can view the configuration of the sensors in the Web Ui. The following sensor classes have been defined to facilitate their use with the Python Api. These classes can only be used if the sensor configuration of the ego vehicle includes the sensor.</p>
<ul>
<li><strong>CameraSensor</strong> - see <a href="#camera-sensor">Camera</a> sensor</li>
<li><strong>LidarSensor</strong> - see <a href="#lidar-sensor">LiDAR</a> sensor</li>
<li><strong>ImuSensor</strong> - see <a href="#imu-sensor">IMU</a> sensor</li>
<li><strong>GpsSensor</strong> - see <a href="#gps-sensor">GPS</a> sensor</li>
<li><strong>RadarSensor</strong> - see <a href="#radar-sensor">Radar</a> sensor</li>
<li><strong>CanBusSensor</strong> - see <a href="#can-bus">CAN bus</a> sensor</li>
<li><strong>VideoRecordingSensor</strong> - see <a href="#video-recording">Video Recording</a> sensor</li>
</ul>
<p>Each sensor has the following common members:</p>
<ul>
<li><code>name</code> - name of sensor, to differentiate sensors of the same type, for example, to choose one out of multiple cameras attached to EgoVehicle</li>
<li><code>transform</code> - property that contains position and rotation of a sensor relative to the agent transform</li>
<li><code>enabled</code> - bool property, set to <code>True</code> if sensor is enabled for capturing and sending data to
   ROS or Cyber bridge</li>
</ul>
<h3 id="camera-sensor">Camera Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#camera-sensor" title="Permanent link">#</a></h3>
<p>The Camera sensor has the following read only properties:</p>
<ul>
<li><code>frequency</code> - rate at which images are captured &amp; sent to ROS or Cyber bridge</li>
<li><code>width</code> - image width</li>
<li><code>height</code> - image height</li>
<li><code>fov</code> - vertical field of view in degrees</li>
<li><code>near_plane</code> - distance of near plane</li>
<li><code>far_plane</code> - distance of far plane</li>
<li><code>format</code> - format of image ("RGB" for 24-bit color image, "DEPTH" - 8-bit grayscale depth buffer,
   "SEGMENTATION" - 24-bit color image with semantic/instance segmentation)</li>
</ul>
<p>Camera image can be saved to disk by calling <code>save</code>:</p>
<pre><code class="language-python">ego = sim.add_agent(&quot;47b529db-0593-4908-b3e7-4b24a32a0f70&quot;, lgsvl.AgentType.EGO)

for sensor in ego.get_sensors():
  if sensor.name = &quot;Main Camera&quot;:
    sensor.save(&quot;main-camera.png&quot;, compression=0)
</code></pre>
<p><code>save</code> method accepts a path relative to the running simulator, and an optional <code>compression</code> for png files (0...9)
or <code>quality</code> (0..100) for jpeg files.</p>
<h3 id="lidar-sensor">LiDAR Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#lidar-sensor" title="Permanent link">#</a></h3>
<p>LiDAR sensor has following read only properties:</p>
<ul>
<li><code>min_distance</code> - minimal distance for capturing points</li>
<li><code>max_distance</code> - maximum distance for capturing points</li>
<li><code>rays</code> - how many laser rays (vertically) to use</li>
<li><code>rotations</code> - frequency of rotation, typically 10Hz</li>
<li><code>measurements</code> - how many measurements per rotation each ray is taking</li>
<li><code>fov</code> - vertical field of view (bottom to top ray) in degrees</li>
<li><code>angle</code> - angle LiDAR is tilted (middle of fov view)</li>
<li><code>compensated</code> - bool, whether LiDAR point cloud is compensated</li>
</ul>
<p>LiDAR point cloud can be saved to disk as a .pcd file by calling <code>save</code>:</p>
<pre><code class="language-python">ego = sim.add_agent(&quot;47b529db-0593-4908-b3e7-4b24a32a0f70&quot;, lgsvl.AgentType.EGO)

for sensor in ego.get_sensors():
  if sensor.name = &quot;Lidar&quot;:
    sensor.save(&quot;lidar.pcd&quot;)
</code></pre>
<p>A <code>.pcd</code> file is in the <a href="http://pointclouds.org/documentation/tutorials/pcd_file_format.html">binary Point Cloud Data format</a> where each point has x/y/z coordinates as 4-byte floats and a 1-byte unsigned int as intensity (0...255).</p>
<h3 id="imu-sensor">IMU Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#imu-sensor" title="Permanent link">#</a></h3>
<p>You can use the IMU sensor to get its position in the vehicle. All measurements an IMU would provide can be obtained by using the <code>transform</code> property of the agent.</p>
<h3 id="gps-sensor">GPS Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#gps-sensor" title="Permanent link">#</a></h3>
<p>You can retrieve the current GPS location from the GPS sensor by calling <code>data</code>:</p>
<pre><code class="language-python">data = gps_sensor.data()
print(&quot;Latitude:&quot;, data.latitude)
</code></pre>
<p>Returned data will contain following fields:</p>
<ul>
<li><code>latitude</code></li>
<li><code>longitude</code></li>
<li><code>northing</code></li>
<li><code>easting</code></li>
<li><code>altitude</code></li>
<li><code>orientation</code> - rotation around up-axis in degrees</li>
</ul>
<h3 id="radar-sensor">Radar Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#radar-sensor" title="Permanent link">#</a></h3>
<p>Currently the Radar sensor can be used only to get its position and rotation in the vehicle. Radar measurements can be received in ROS or Cyber by setting the <code>enabled</code> property of the sensor.</p>
<h3 id="can-bus">CAN bus <a class="wikilink" href="#top">top</a><a class="headerlink" href="#can-bus" title="Permanent link">#</a></h3>
<p>Currently CAN bus can be used only to get its position and rotation in the vehicle. CAN bus messages can be received in ROS or Cyber by setting the <code>enabled</code> property of the sensor.</p>
<h3 id="video-recording">Video Recording Sensor <a class="wikilink" href="#top">top</a><a class="headerlink" href="#video-recording" title="Permanent link">#</a></h3>
<p>The Video Recording sensor is used to record a video of test cases for playback afterward. The following parameters can be set to configure the video recording:</p>
<ul>
<li><code>width</code> - width of the video in pixels</li>
<li><code>height</code> - height of the video in pixels</li>
<li><code>framerate</code> - the number of frames per second in the video</li>
<li><code>min_distance</code> - the minimum distance from the camera for which objects are rendered</li>
<li><code>max_distance</code> - the maximum distance from the camera for which objects are rendered</li>
<li><code>fov</code> - the vertical field of view of the camera in degrees</li>
<li><code>quality</code> - the target constant quality level for VBR rate control (0 to 51, 0 means automatic)</li>
<li><code>bitrate</code> - the average number of bits per second</li>
<li><code>max_bitrate</code> - the maximum number of bits per second</li>
</ul>
<h2 id="weather-and-time-of-day-control">Weather and Time of Day Control <a class="wikilink" href="#top">top</a><a class="headerlink" href="#weather-and-time-of-day-control" title="Permanent link">#</a></h2>
<p>You can control the weather properties of the simulation by reading or writing to the <code>weather</code> property. You can
set <code>rain</code>, <code>fog</code>, <code>wetness</code>, <code>cloudiness</code>, and <code>damage</code> (referring to road damage) as a float in 0..1 range. Example:</p>
<pre><code class="language-python">w = sim.weather
w.rain = 0.5     # set rain to 50%
sim.weather = w
</code></pre>
<p>Changing time of day allows to control whether the loaded scene appears as day or night.
To get the current time read the <code>time_of_day</code> property:</p>
<pre><code class="language-python">print(&quot;Current time of day:&quot;, sim.time_of_day)
</code></pre>
<p>It will return a float between 0 and 24. To set time of day call <code>set_time_of_day</code>:</p>
<pre><code class="language-python">sim.set_time_of_day(10, fixed=True)
</code></pre>
<p>This will set current time of day to 10 AM of the current date. The date and time of day are important because they determine the position of the sun and directly effect lighting in the scene. The optional bool argument <code>fixed</code> indicates whether the simulation should advance this time automatically or freeze it and not change it (<code>fixed=True</code>).</p>
<p>For fine-tuned control of time of day, or to set a custom date along with the time of day call <code>set_datetime</code> which takes a Python <code>datetime</code> object as input:</p>
<pre><code class="language-python">from datetime import datetime

dt = datetime(
  year=2020,
  month=12,
  day=25,
  hour=13,
  minute = 0,
  second = 0
)
sim.set_datetime(dt)
</code></pre>
<h2 id="controllable-objects">Controllable Objects <a class="wikilink" href="#top">top</a><a class="headerlink" href="#controllable-objects" title="Permanent link">#</a></h2>
<p>A controllable object is an object that you can control by performing an action using Python APIs. Each controllable object has its own <code>valid actions</code> (e.g., green, yellow, red, trigger, wait, loop) that it can take and is controlled based on <code>control policy</code>, which defines rules for control actions.</p>
<p>For example, a traffic light is a controllable object, and you can change its behavior by updating control policy: <code>"trigger=50;green=1;yellow=1.5;red=2;loop"</code></p>
<ul>
<li><code>trigger=50</code> - Wait until an ego vehicle approaches this controllable object within 50 meters</li>
<li><code>green=1</code> - Change current state to <code>green</code> and wait for 1 second</li>
<li><code>yellow=1.5</code> - Change current state to <code>yellow</code> and wait for 1.5 second</li>
<li><code>red=2</code> - Change current state to <code>red</code> and wait for 2 second</li>
<li><code>loop</code> - Loop over this control policy from the beginning</li>
</ul>
<p>Available controllable object types:</p>
<ul>
<li><strong>signal</strong></li>
<li><strong><a href="https://github.com/lgsvl/TrafficCone">cone</a></strong></li>
</ul>
<p>All Controllable objects can be added or removed dynamically. When reset() is called, all Controllables are removed and the ones in the map (if any) are added back. Controllable objects can be loaded plugins at runtime.  Plugin must include <code>IControllable</code> and be built using the Simulator build process from the <code>Assets/External/Controllables</code> folder.</p>
<p>To get a list of controllable objects in a scene:</p>
<pre><code class="language-python">controllables = sim.get_controllables()
</code></pre>
<p>For a controllable object of interest, you can get following information:</p>
<pre><code class="language-python">signal = controllables[0]
print(&quot;Type:&quot;, signal.type)
print(&quot;Transform:&quot;, signal.transform)
print(&quot;Current state:&quot;, signal.current_state)
print(&quot;Valid actions:&quot;, signal.valid_actions)
</code></pre>
<p>For control policy, each controllable object always has default control policy (read-only). When you load a scene for the first time or reset a scene to the initial state, a controllable object resets current control policy to default one follows it.</p>
<p>You can get default control policy and current control policy as follows:</p>
<pre><code class="language-python">print(&quot;Default control policy:&quot;, signal.default_control_policy)
print(&quot;Current control policy:&quot;, signal.control_policy)
</code></pre>
<p>To change a current control policy, you can create a new control policy and call <code>control</code> function as below:</p>
<pre><code class="language-python">control_policy = &quot;trigger=50;green=1;yellow=1.5;red=2;loop&quot;
signal.control(control_policy)
</code></pre>
<p>To add a plugin controllable and set object state</p>
<pre><code class="language-python">state = lgsvl.ObjectState()
state.transform.position = lgsvl.Vector(0,0,0)
state.transform.rotation = lgsvl.Vector(0,0,0)
state.velocity = lgsvl.Vector(0,10,0)
state.angular_velocity = lgsvl.Vector(6.5,0,0)

cone = sim.controllable_add(&quot;TrafficCone&quot;, state)
</code></pre>
<p>To get plugin controllable object state</p>
<pre><code class="language-python">cone.object_state
</code></pre>
<p>To set plugin controllable object state</p>
<pre><code class="language-python">state = lgsvl.ObjectState()
state.transform.position = lgsvl.Vector(0, 0, -10)
cone.object_state = state
</code></pre>
<h2 id="helper-functions">Helper Functions <a class="wikilink" href="#top">top</a><a class="headerlink" href="#helper-functions" title="Permanent link">#</a></h2>
<p>Simulator class offers following helper functions:</p>
<ul>
<li><code>version</code> - property that returns current version of simulator as string</li>
<li><code>layer</code> - property that returns all named Unity physics layers</li>
<li><code>current_scene</code> - property that returns currently loaded scene as string, None if none is loaded</li>
<li><code>current_frame</code> - property that returns currently simulated frame number as integer</li>
<li><code>current_time</code> - property that returns currently simulation time in seconds as float</li>
<li><code>get_spawn</code> - method that returns list of <code>Spawn</code> objects representing good positions to place vehicles in the map. This list can be empty, it depends on how the map is prepared in Unity. Returned <code>Spawn</code> objects contain a <code>transform</code> which holds <code>position</code> and <code>rotation</code> members as a <code>Vector</code>, as well as <code>destinations</code> which holds valid destination points for an ego vehicle starting at the spawn point as an array of <code>transforms</code>.</li>
<li><code>get_agents</code> - method that returns a list of currently available agent objects added with <code>add_agent</code></li>
<li><code>map_from_nav</code> - method that maps transform (position &amp; rotation) in Nav2 coordinates to Unity coordinates</li>
<li><code>set_nav_origin</code> - method that sets NavOrigin values in a scene</li>
<li><code>get_nav_origin</code> - method that gets NavOrigin values in a scene</li>
</ul>
<p>To map points in Unity coordinates to GPS coordinates the Simulator class offers the following two functions:</p>
<ul>
<li><code>map_to_gps</code> - maps transform (position &amp; rotation) to GPS location, returns same type as
    <a href="#gps-sensor">GPS Sensor</a> <code>data</code> method</li>
<li><code>map_from_gps</code> - maps GPS location (latitude/longitude or northing/easting) to transform</li>
<li><code>raycast</code> - shoots a ray from specific location and returns closest object it hits</li>
</ul>
<p><code>map_from_gps</code> accepts two different inputs - latitude/longitude or northing/easting. Examples:</p>
<pre><code class="language-python">tr1 = sim.map_from_gps(latitude=10, longitude=-30)
tr2 = sim.map_from_gps(northing=123455, easting=552341)
</code></pre>
<p>Optionally you can pass altitude and orientation.</p>
<p><code>raycast</code> method can be used in following way:</p>
<pre><code class="language-python">origin = lgsvl.Vector(10, 0, 20)
direction = lgsvl.Vector(1, 0, 0)
hit = sim.raycast(origin, direction, layer_mask=1)
if hit:
  print(&quot;Distance right:&quot;, hit.distance)
</code></pre>
<p>This will shoot a ray in the positive <em>x</em>-axis direction from the <em>(10, 0, 20)</em> coordinates.
A <code>RaycastHit</code> object with <code>distance</code>, <code>point</code> and <code>normal</code> fields is returned if something is hit, otherwise <code>None</code> is returned.</p>
<p>When raycasting you should specify a <code>layer_mask</code> argument that specifies which objects to check
collision with. It corresponds to layers in the Unity project - check the project for actual values or use the layer property.</p>
<table>
<thead>
<tr>
<th>layer_mask</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Default</td>
<td>roads must use this layer*</td>
</tr>
<tr>
<td>1</td>
<td>TransparentFX</td>
<td>used to ignore FX with transparency*</td>
</tr>
<tr>
<td>2</td>
<td>Ignore Raycast</td>
<td>used to ignore any raycasts against*</td>
</tr>
<tr>
<td>4</td>
<td>Water</td>
<td>not used*</td>
</tr>
<tr>
<td>5</td>
<td>UI</td>
<td>used to cull UI in scene*</td>
</tr>
<tr>
<td>8</td>
<td>PostProcessing</td>
<td>used to cull postprocessing effects</td>
</tr>
<tr>
<td>9</td>
<td>Agent</td>
<td>ego vehicles</td>
</tr>
<tr>
<td>10</td>
<td>NPC</td>
<td>npc vehicles</td>
</tr>
<tr>
<td>11</td>
<td>Pedestrian</td>
<td>pedestrians</td>
</tr>
<tr>
<td>12</td>
<td>Obstacle</td>
<td>sign poles, buildings</td>
</tr>
<tr>
<td>13</td>
<td>Sensor</td>
<td>used to cull sensor effects</td>
</tr>
<tr>
<td>14</td>
<td>GroundTruthRange</td>
<td>used to cull ground truth range</td>
</tr>
<tr>
<td>15</td>
<td>GroundTruth</td>
<td>used to cull ground truth triggers</td>
</tr>
<tr>
<td>16</td>
<td>Lane</td>
<td>used to cull lane triggers</td>
</tr>
<tr>
<td>31</td>
<td>SkyEffects</td>
<td>used to cull clouds</td>
</tr>
</tbody>
</table>
<p><code>*</code> Default Unity Physics Layers</p>
<h2 id="changelog">Changelog <a class="wikilink" href="#top">top</a><a class="headerlink" href="#changelog" title="Permanent link">#</a></h2>
<ul>
<li>2020-08-28<ul>
<li>Added support for time-to-collision and distance-to-collision triggers for NPCs and pedestrians</li>
</ul>
</li>
<li>2020-05-22<ul>
<li>Added suport for setting pedestrian travel speed</li>
</ul>
</li>
<li>
<p>2020-01-30</p>
<ul>
<li>Extended controllable objects to support plugins - see <a href="../../plugins/controllable-plugins/">controllable plugins</a></li>
</ul>
</li>
<li>
<p>2019-09-05</p>
<ul>
<li>Extended <code>DriveWaypoint</code> to support angle, idle time and trigger distance</li>
<li>Added controllable objects - use <code>Simulator.get_controllables</code></li>
</ul>
</li>
<li>
<p>2019-08-12</p>
<ul>
<li>Added <code>time_scale</code> argument to run function for running simulation in non-realtime</li>
<li>Added <code>seed</code> argument to <code>Simulator.load</code> for deterministic NPCs</li>
</ul>
</li>
<li>
<p>2019-04-19</p>
<ul>
<li>initial release</li>
</ul>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api-quickstart-descriptions/" class="btn btn-neutral float-right" title="Python API quickstart guide">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../visual-scenario-editor/vse-extensions/" class="btn btn-neutral" title="VSE Extensions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2019-2022 LG Electronics Inc.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/lgsvl/simulator/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../visual-scenario-editor/vse-extensions/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../api-quickstart-descriptions/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../javascripts/clipboard.js" defer></script>
      <script src="../../javascripts/copy-to-clipboard.js" defer></script>
      <script src="../../javascripts/config.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
